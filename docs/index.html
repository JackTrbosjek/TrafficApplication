<!DOCTYPE html>
<html>

<head>
    <meta name="viewport" content="initial-scale=1.0, user-scalable=no">
    <meta charset="utf-8">
    <title>Info windows</title>
    <style>
        /* Always set the map height explicitly to define the size of the div
       * element that contains the map. */

        #map {
            height: 100%;
        }
        /* Optional: Makes the sample page fill the window. */

        html,
        body {
            height: 100%;
            margin: 0;
            padding: 0;
        }
    </style>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
    <script src="http://underscorejs.org/underscore-min.js"></script>
</head>

<body>
    <div id="map"></div>
    <script>
        // This example displays a marker at the center of Australia.
        // When the user clicks the marker, an info window opens.
        var map;
        function initMap() {
            var uluru = { lat: -25.363, lng: 131.044 };
            map = new google.maps.Map(document.getElementById('map'), {
                zoom: 4,
                center: uluru
            });

        }
        $(document).ready(function () {

            loadResources();

        });

        function loadResources() {
            $.get("https://api.baasic.com/v1/traffic-application/resources/File/?page=1&rpp=25&sort=id%7Casc", function (data, status) {
                console.log(data);
                setupMarkers(data);
            });
        }

        function setupMarkers(data) {
            _.each(data.item, function (item) {
                var contentString = '';
                if (item.is_image) {
                    contentString = '<img src="' + item.file_url + '" height="150" width="150"/>';
                } else {
                    contentString = '<video width="320" height="240" controls>  <source src="' + item.file_url + '" type="video/mp4"></video>';
                }
                //var contentString = '<img src="https://api.baasic.com/v1/traffic-application/file-streams/jFqMSlwgjKzODbF7WBZIK0" height="150" width="150"/>';

                //var contentString = '<video width="320" height="240" controls>  <source src="https://api.baasic.com/v1/traffic-application/file-streams/acark9izBgFT5DF7WAzs64" type="video/mp4"></video>';
                var infowindow = new google.maps.InfoWindow({
                    content: contentString
                });
                var location = { lat: Number(item.latitude), lng: Number(item.longitude) };
                var marker = new google.maps.Marker({
                    position: location,
                    map: map,
                    title: 'Marker Title'
                });
                marker.addListener('click', function () {
                    infowindow.open(map, marker);
                });
            });
        }
    </script>
    <script async defer src="https://maps.googleapis.com/maps/api/js?key=AIzaSyB0hoL7l84TMovuIeIYy8ujjVA4a1WSqzA&callback=initMap">

    </script>
</body>

</html>